<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Dominic Magirr">

  
  
  
    
  
  <meta name="description" content="I’m delighted that our new R package {nphRCT} is available on CRAN. Special thanks to Isobel Barrot. Her R skills have made this possible. Thanks also to Carl-Fredrik Burman and José Jiménez, my collaborators on this topic over the past few years.
library(dplyr) library(ggplot2) library(survival) #devtools::install_github(&quot;https://github.com/cran/nphRCT.git&quot;) library(nphRCT) The idea for the package was to make it easy to perform a weighted log-rank test, and in particular the modestly-weighted logrank test, in the context of an Randomized Controlled Trial (RCT) where one expects a delayed separation of survival curves.">

  
  <link rel="alternate" hreflang="en-us" href="/post/2022-09-01-nphrct/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/2022-09-01-nphrct/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Dominic Magirr">
  <meta property="og:url" content="/post/2022-09-01-nphrct/">
  <meta property="og:title" content="{nphRCT} on CRAN | Dominic Magirr">
  <meta property="og:description" content="I’m delighted that our new R package {nphRCT} is available on CRAN. Special thanks to Isobel Barrot. Her R skills have made this possible. Thanks also to Carl-Fredrik Burman and José Jiménez, my collaborators on this topic over the past few years.
library(dplyr) library(ggplot2) library(survival) #devtools::install_github(&quot;https://github.com/cran/nphRCT.git&quot;) library(nphRCT) The idea for the package was to make it easy to perform a weighted log-rank test, and in particular the modestly-weighted logrank test, in the context of an Randomized Controlled Trial (RCT) where one expects a delayed separation of survival curves."><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2022-09-01T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2022-09-01T14:00:01&#43;00:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/2022-09-01-nphrct/"
  },
  "headline": "{nphRCT} on CRAN",
  
  "datePublished": "2022-09-01T00:00:00Z",
  "dateModified": "2022-09-01T14:00:01Z",
  
  "author": {
    "@type": "Person",
    "name": "Dominic Magirr"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Dominic Magirr",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "I’m delighted that our new R package {nphRCT} is available on CRAN. Special thanks to Isobel Barrot. Her R skills have made this possible. Thanks also to Carl-Fredrik Burman and José Jiménez, my collaborators on this topic over the past few years.\nlibrary(dplyr) library(ggplot2) library(survival) #devtools::install_github(\u0026quot;https://github.com/cran/nphRCT.git\u0026quot;) library(nphRCT) The idea for the package was to make it easy to perform a weighted log-rank test, and in particular the modestly-weighted logrank test, in the context of an Randomized Controlled Trial (RCT) where one expects a delayed separation of survival curves."
}
</script>

  

  


  


  





  <title>{nphRCT} on CRAN | Dominic Magirr</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Dominic Magirr</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>{nphRCT} on CRAN</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Sep 1, 2022
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p>I’m delighted that <a href="https://cran.r-project.org/package=nphRCT">our new R package {nphRCT} is available on CRAN</a>. Special thanks to <a href="https://github.com/isobelbarrott">Isobel Barrot</a>. Her R skills have made this possible. Thanks also to Carl-Fredrik Burman and <a href="https://jjimenezm1989.github.io/">José Jiménez</a>, my collaborators on this topic over the past few years.</p>
<pre class="r"><code>library(dplyr)
library(ggplot2)
library(survival)
#devtools::install_github(&quot;https://github.com/cran/nphRCT.git&quot;)
library(nphRCT)</code></pre>
<p>The idea for the package was to make it easy to perform a weighted log-rank test, and in particular the <a href="https://doi.org/10.1002/sim.8186">modestly-weighted logrank test</a>, in the context of an Randomized Controlled Trial (RCT) where one expects a delayed separation of survival curves.</p>
<div id="example-data-set" class="section level1">
<h1>Example data set</h1>
<p>A dataset I often use as an example in this context is the <a href="https://www.nature.com/articles/s41591-018-0134-3">POPLAR trial data</a>.</p>
<p>Let’s find the data from the web, and plot the Kaplan-Meier curves…</p>
<pre class="r"><code>template &lt;- tempfile(fileext = &quot;.xlsx&quot;)

httr::GET(url = &quot;https://static-content.springer.com/esm/art%3A10.1038%2Fs41591-018-0134-3/MediaObjects/41591_2018_134_MOESM3_ESM.xlsx&quot;, 
          httr::write_disk(template))</code></pre>
<pre class="r"><code>dat &lt;- readxl::read_excel(template,sheet = 2) %&gt;% 
  select(PtID, ECOGGR, OS, OS.CNSR, TRT01P) %&gt;%
  mutate(event = -1 * (OS.CNSR - 1),
         time = OS,
         arm = ifelse(TRT01P == &quot;Docetaxel&quot;, &quot;control&quot;, &quot;experimental&quot;)) %&gt;% 
  select(time, event, arm) %&gt;%
  as.data.frame()

km &lt;- survfit(Surv(time, event) ~ arm, data = dat)</code></pre>
<pre class="r"><code>survminer::ggsurvplot(km, 
                      data = dat, 
                      risk.table = TRUE, 
                      break.x.by = 6,
                      legend.title = &quot;&quot;,
                      xlab = &quot;Time (months)&quot;,
                      ylab = &quot;Overall survival&quot;,
                      risk.table.fontsize = 4,
                      legend = c(0.8,0.8))</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="at-risk-table" class="section level1">
<h1>At-risk table</h1>
<p>The at-risk table (per arm) may be a good place to start. If we want, we can look at this via <code>find_at_risk</code>. The syntax should be familiar from the <code>{survival}</code> package.</p>
<pre class="r"><code>at_risk &lt;- nphRCT::find_at_risk(Surv(time, event) ~ arm, 
                                data = dat,
                                include_cens = FALSE)

head(at_risk)</code></pre>
<pre><code>##         t_j n_event_control n_event_experimental n_event n_risk_control
## 1 0.1971253               1                    0       1            138
## 2 0.2299795               0                    1       1            137
## 3 0.2956879               1                    0       1            137
## 4 0.3613963               1                    1       2            136
## 5 0.4599589               1                    2       3            135
## 6 0.5585216               0                    1       1            134
##   n_risk_experimental n_risk
## 1                 144    282
## 2                 144    281
## 3                 143    280
## 4                 143    279
## 5                 142    277
## 6                 140    274</code></pre>
<p>The weighted log-rank test statistic is</p>
<p><span class="math display">\[
U^W = \sum_{j=1}^k w_j \left\lbrace \text{n_event_control}(t_{j}) - \text{n_event}(t_{j}) \times \frac{\text{n_risk_control}(t_{j})}{\text{n_risk}(t_{j})}\right\rbrace
\]</span></p>
</div>
<div id="weights" class="section level1">
<h1>Weights</h1>
<div id="modestly-weighted" class="section level2">
<h2>Modestly-weighted</h2>
<p>The modestly weighted log-rank test uses weights <span class="math inline">\(w_j = 1 / \max\{\hat{S}(t_j-), s^*\}\)</span>, where <span class="math inline">\(\hat{S}(t_j-)\)</span> is the Kaplan-Meier estimate at <span class="math inline">\(t_j-\)</span> (just prior to event time <span class="math inline">\(t_j\)</span>) based on the pooled (both arms) data, and <span class="math inline">\(s^* \in (0,1]\)</span> is pre-specified. For example, taking <span class="math inline">\(s^*=0.5\)</span>…</p>
<pre class="r"><code>weights_mw_s &lt;- nphRCT::find_weights(Surv(time, event) ~ arm, 
                                     data = dat,
                                     method = &quot;mw&quot;,
                                     s_star = 0.5)


plot(at_risk$t_j, weights_mw_s, ylim = c(0,2),
     xlab = &quot;Event time&quot;,
     ylab = &quot;Weight&quot;,
     main = &quot;Modestly weighted, s*=0.5&quot;)</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>In this case, the weight for the first event time is 1, and weights are increasing but capped at 2 at the time the KM curve drops to 0.5 (at around 12 months).</p>
<p>Alternatively, one could choose <span class="math inline">\(w_j = 1 / \max\{\hat{S}(t_j-), \hat{S}(t^*)\}\)</span>, where <span class="math inline">\(t^*\)</span> is a pre-specified timepoint beyond which the weights no longer increase. The weights are then capped at <span class="math inline">\(1 / \hat{S}(t^*)\)</span>. For example, taking <span class="math inline">\(t^* = 6\)</span>,</p>
<pre class="r"><code>weights_mw_t &lt;- nphRCT::find_weights(Surv(time, event) ~ arm, 
                                     data = dat,
                                     method = &quot;mw&quot;,
                                     t_star = 6)


plot(at_risk$t_j, weights_mw_t, ylim = c(0,2),
     xlab = &quot;Event time&quot;,
     ylab = &quot;Weight&quot;,
     main = &quot;Modestly weighted, t*=6&quot;)</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div id="special-case-s1-or-t0" class="section level3">
<h3>Special case: <span class="math inline">\(s^*=1\)</span> (or <span class="math inline">\(t^*=0\)</span>)</h3>
<p>The special case <span class="math inline">\(s^*=1\)</span> (or <span class="math inline">\(t^*=0\)</span>) is the same as the standard log-rank test.</p>
</div>
</div>
<div id="fleming-harrington-rho-gamma-test" class="section level2">
<h2>Fleming-Harrington <span class="math inline">\((\rho, \gamma)\)</span> test</h2>
<p>The Fleming-Harrington <span class="math inline">\((\rho, \gamma)\)</span> weights are <span class="math inline">\(\hat{S}(t_j-)^{\rho}\{1 - \hat{S}(t_j-) \}^{\gamma}\)</span>. Often, in delayed effect scenarios, <span class="math inline">\(\rho=0\)</span> and <span class="math inline">\(\gamma=1\)</span> is chosen.</p>
<pre class="r"><code>weights_fh_0_1 &lt;- nphRCT::find_weights(Surv(time, event) ~ arm, 
                                       data = dat,
                                       method = &quot;fh&quot;,
                                       rho = 0,
                                       gamma = 1)


plot(at_risk$t_j, weights_fh_0_1, ylim = c(0,1),
     xlab = &quot;Event time&quot;,
     ylab = &quot;Weight&quot;,
     main = &quot;Fleming-Harrington (0,1)&quot;)</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-8-1.png" width="672" />
The main difference between F-H(0,1) weights and the modest weights is that the F-H(0,1) weights start at zero. The early events are therefore much more heavily down-weighted compared to the modest test.</p>
<div id="special-case-rho-gamma-0" class="section level3">
<h3>Special case: <span class="math inline">\(\rho = \gamma = 0\)</span></h3>
<p>The special case <span class="math inline">\(\rho = \gamma = 0\)</span> is the same as the standard log-rank test.</p>
</div>
</div>
</div>
<div id="performing-the-weighted-log-rank-test" class="section level1">
<h1>Performing the weighted log-rank test</h1>
<p>To perform the weighed log-rank test use the <code>wlrt</code> function.</p>
<pre class="r"><code># Modestly-weighted (t*=6)
nphRCT::wlrt(Surv(time, event) ~ arm, 
             data = dat,
             method = &quot;mw&quot;,
             t_star = 6)</code></pre>
<pre><code>##           u      v_u         z    trt_group
## 1 -26.11708 83.62023 -2.856071 experimental</code></pre>
<pre class="r"><code># Standard log-rank test (t*=0)
nphRCT::wlrt(Surv(time, event) ~ arm, 
             data = dat,
             method = &quot;mw&quot;,
             t_star = 0)</code></pre>
<pre><code>##           u      v_u         z    trt_group
## 1 -19.42566 49.15217 -2.770796 experimental</code></pre>
<pre class="r"><code># Fleming-Harrington (0,1)
nphRCT::wlrt(Surv(time, event) ~ arm, 
             data = dat,
             method = &quot;fh&quot;,
             rho = 0,
             gamma = 1)</code></pre>
<pre><code>##           u      v_u         z    trt_group
## 1 -9.942946 8.522577 -3.405882 experimental</code></pre>
</div>
<div id="visualization-of-test-statistic-difference-in-mean-score" class="section level1">
<h1>Visualization of test statistic: difference in mean score</h1>
<p>It’s possible to visualize a weighted log-rank test as a difference in mean “score” on the two treatment arms, where the scores are a transformation of the 2-dimensional outcomes (time, event status) to the real line. This is explained in more detail <a href="https://doi.org/10.1002/pst.2091">here</a>.</p>
<p>We’ll try it now for our examples. In these plots, each dot corresponds to a patient in the trial. On the x-axis is their time-to-event/censoring, and on the y-axis is their score. For the log-rank test, we see two almost parallel lines, with the top line corresponding to the observed events, and the bottom line corresponding to censored observations. So someone who dies at month 1 gets a score close to 1 (the worst score), and someone who is censored at month 24 gets a score close to -1 (the best score). Note that the scaling is arbitrary. The dashed horizontal lines represent the mean score on the two treatment arms. The difference between these to lines <em>is</em> the log-rank test statistic (a re-scaled version of it).</p>
<pre class="r"><code># Standard log-rank test (t*=0)
nphRCT::find_scores(Surv(time, event) ~ arm, 
             data = dat,
             method = &quot;mw&quot;,
             t_star = 0) %&gt;% plot()</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>For the modestly-weighted test, the scores (for observed events) are essentially fixed at 1 until time <span class="math inline">\(t^*\)</span>. This is by design.</p>
<pre class="r"><code># Modestly-weighted (t*=6)
nphRCT::find_scores(Surv(time, event) ~ arm, 
             data = dat,
             method = &quot;mw&quot;,
             t_star = 6) %&gt;% plot()</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>In contrast, for the Fleming-Harrington-(0,1) test, the scores (for observed events) are increasing with time for early follow-up times. So someone who dies at month 1 gets a lower (better) score than someone who dies at month 12. Basically, one has downweighted the early events to such an extent that the test actually “rewards” the experimental treatment for causing early harm.</p>
<pre class="r"><code># Fleming-Harrington (0,1)
nphRCT::find_scores(Surv(time, event) ~ arm, 
             data = dat,
             method = &quot;fh&quot;,
             rho = 0,
             gamma = 1) %&gt;% plot()</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Other versions of Fleming-Harrington test e.g., (1,1), (0,0.5), (0.5,0.5), etc. suffer from the same problem.</p>
<pre class="r"><code># Fleming-Harrington (1,1)
nphRCT::find_scores(Surv(time, event) ~ arm, 
             data = dat,
             method = &quot;fh&quot;,
             rho = 1,
             gamma = 1) %&gt;% plot()</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code># Fleming-Harrington (0,0.5)
nphRCT::find_scores(Surv(time, event) ~ arm, 
             data = dat,
             method = &quot;fh&quot;,
             rho = 0,
             gamma = 0.5) %&gt;% plot()</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
<pre class="r"><code># Fleming-Harrington (0.5,0.5)
nphRCT::find_scores(Surv(time, event) ~ arm, 
             data = dat,
             method = &quot;fh&quot;,
             rho = 0.5,
             gamma = 0.5) %&gt;% plot()</code></pre>
<p><img src="/post/2022-09-01-nphrct_files/figure-html/unnamed-chunk-13-3.png" width="672" /></p>
</div>

    </div>

    


















  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu3ad799765e91f69a41f3acc2fc665a63_309343_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Dominic Magirr</a></h5>
      <h6 class="card-subtitle">Medical Statistician</h6>
      <p class="card-text">Interested in the design, analysis and interpretation of clinical trials.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/dominic-magirr-87666b12b/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=obri2xMAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/dominicmagirr" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/files/cv.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.01f68d44d80310e669a1731b68a35481.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
